<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试页面</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .debug-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .code {
            font-family: monospace;
            background-color: #f0f0f0;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>调试页面</h1>
    
    <div class="debug-section">
        <h2>1. 检查utils对象是否存在</h2>
        <div id="utils-check"></div>
    </div>
    
    <div class="debug-section">
        <h2>2. 检查翻译函数是否存在</h2>
        <div id="functions-check"></div>
    </div>
    
    <div class="debug-section">
        <h2>3. 测试翻译功能</h2>
        <div id="translation-test"></div>
    </div>
    
    <div class="debug-section">
        <h2>4. 测试API调用</h2>
        <div id="api-test"></div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script>
        // 1. 检查utils对象
        const utilsCheckDiv = document.getElementById('utils-check');
        if (typeof utils !== 'undefined') {
            utilsCheckDiv.innerHTML = '<span class="success">✓ utils对象存在</span>';
        } else {
            utilsCheckDiv.innerHTML = '<span class="error">✗ utils对象不存在</span>';
        }
        
        // 2. 检查翻译函数
        const functionsCheckDiv = document.getElementById('functions-check');
        const functions = ['translateColor', 'translateSize', 'translateColors', 'translateSizes', 'getUniqloProductUrl'];
        let functionsHtml = '';
        
        functions.forEach(func => {
            if (typeof utils !== 'undefined' && typeof utils[func] === 'function') {
                functionsHtml += `<div><span class="success">✓</span> <span class="code">${func}</span> 函数存在</div>`;
            } else {
                functionsHtml += `<div><span class="error">✗</span> <span class="code">${func}</span> 函数不存在</div>`;
            }
        });
        
        functionsCheckDiv.innerHTML = functionsHtml;
        
        // 3. 测试翻译功能
        const translationTestDiv = document.getElementById('translation-test');
        if (typeof utils !== 'undefined' && typeof utils.translateColor === 'function') {
            try {
                const colorTest = utils.translateColor('COL09');
                const sizeTest = utils.translateSize('SMA003');
                const colorsTest = utils.translateColors(['COL00', 'COL09']);
                const sizesTest = utils.translateSizes(['SMA003', 'SMA004']);
                const urlTest = utils.getUniqloProductUrl('468503');
                
                translationTestDiv.innerHTML = `
                    <div><span class="success">✓</span> 颜色翻译: COL09 → ${colorTest}</div>
                    <div><span class="success">✓</span> 尺码翻译: SMA003 → ${sizeTest}</div>
                    <div><span class="success">✓</span> 颜色数组翻译: [COL00, COL09] → [${colorsTest.join(', ')}]</div>
                    <div><span class="success">✓</span> 尺码数组翻译: [SMA003, SMA004] → [${sizesTest.join(', ')}]</div>
                    <div><span class="success">✓</span> 官网链接: ${urlTest}</div>
                `;
            } catch (error) {
                translationTestDiv.innerHTML = `<span class="error">✗ 翻译功能测试失败: ${error.message}</span>`;
            }
        } else {
            translationTestDiv.innerHTML = '<span class="error">✗ 翻译函数不可用</span>';
        }
        
        // 4. 测试API调用
        const apiTestDiv = document.getElementById('api-test');
        if (typeof api !== 'undefined') {
            apiTestDiv.innerHTML = '<div>正在测试API调用...</div>';
            
            api.getProduct('468503')
                .then(product => {
                    apiTestDiv.innerHTML = `
                        <div><span class="success">✓</span> API调用成功</div>
                        <div>商品名称: ${product.name_zh}</div>
                        <div>可用颜色: ${JSON.stringify(product.available_colors)}</div>
                        <div>可用尺码: ${JSON.stringify(product.available_sizes)}</div>
                        <div>翻译后颜色: ${utils.translateColors(product.available_colors || []).join(', ')}</div>
                        <div>翻译后尺码: ${utils.translateSizes(product.available_sizes || []).join(', ')}</div>
                    `;
                })
                .catch(error => {
                    apiTestDiv.innerHTML = `<span class="error">✗ API调用失败: ${error.message}</span>`;
                });
        } else {
            apiTestDiv.innerHTML = '<span class="error">✗ api对象不存在</span>';
        }
    </script>
</body>
</html>
