<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸå®APIæµ‹è¯• - ä¼˜è¡£åº“ä»·æ ¼ç›‘æ§</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .test-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            background: var(--surface);
        }
        
        .test-input {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .test-input input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
        }
        
        .test-input button {
            padding: 0.75rem 1.5rem;
            background: var(--primary-500);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
        }
        
        .test-input button:hover {
            background: var(--primary-600);
        }
        
        .test-input button:disabled {
            background: var(--gray-400);
            cursor: not-allowed;
        }
        
        .result-container {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: var(--radius-md);
            max-height: 400px;
            overflow-y: auto;
        }
        
        .result-container pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .loading {
            color: var(--primary-500);
        }
        
        .error {
            color: var(--error-500);
        }
        
        .success {
            color: var(--success-500);
        }
        
        .product-preview {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: white;
        }
        
        .product-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: var(--radius-md);
        }
        
        .product-info h4 {
            margin: 0 0 0.5rem 0;
        }
        
        .product-info p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>çœŸå®APIæµ‹è¯•</h1>
        <p>æµ‹è¯•æ¯ä¸ªå•†å“çš„å®˜æ–¹è¯¦ç»†ä¿¡æ¯è·å–åŠŸèƒ½</p>
        
        <!-- å•†å“ä»£ç æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ” å•†å“è¯¦ç»†ä¿¡æ¯æµ‹è¯•</h3>
            <div class="test-input">
                <input type="text" id="productCode" placeholder="è¾“å…¥å•†å“ä»£ç  (ä¾‹å¦‚: 479308)" value="479308">
                <button onclick="testProductDetail()">è·å–è¯¦ç»†ä¿¡æ¯</button>
            </div>
            <div id="productResult" class="result-container" style="display: none;"></div>
        </div>
        
        <!-- SPUæ•°æ®æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“Š SPUæ•°æ®æµ‹è¯•</h3>
            <div class="test-input">
                <input type="text" id="spuCode" placeholder="è¾“å…¥å•†å“ä»£ç " value="479308">
                <button onclick="testSPUData()">è·å–SPUæ•°æ®</button>
            </div>
            <div id="spuResult" class="result-container" style="display: none;"></div>
        </div>
        
        <!-- å›¾ç‰‡æ•°æ®æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ–¼ï¸ å›¾ç‰‡æ•°æ®æµ‹è¯•</h3>
            <div class="test-input">
                <input type="text" id="imageCode" placeholder="è¾“å…¥å•†å“ä»£ç " value="479308">
                <button onclick="testImageData()">è·å–å›¾ç‰‡æ•°æ®</button>
            </div>
            <div id="imageResult" class="result-container" style="display: none;"></div>
        </div>
        
        <!-- å®Œæ•´å®˜æ–¹æ•°æ®æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ¯ å®Œæ•´å®˜æ–¹æ•°æ®æµ‹è¯•</h3>
            <div class="test-input">
                <input type="text" id="officialCode" placeholder="è¾“å…¥å•†å“ä»£ç " value="479308">
                <button onclick="testOfficialData()">è·å–å®Œæ•´å®˜æ–¹æ•°æ®</button>
            </div>
            <div id="officialResult" class="result-container" style="display: none;"></div>
            <div id="officialPreview"></div>
        </div>
        
        <!-- å•†å“åˆ—è¡¨æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“‹ ä»å•†å“åˆ—è¡¨æµ‹è¯•</h3>
            <button onclick="loadProductList()">åŠ è½½å•†å“åˆ—è¡¨</button>
            <div id="productListResult" class="result-container" style="display: none;"></div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script>
        async function testProductDetail() {
            const code = document.getElementById('productCode').value;
            const resultDiv = document.getElementById('productResult');
            
            if (!code) {
                alert('è¯·è¾“å…¥å•†å“ä»£ç ');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è·å–å•†å“è¯¦ç»†ä¿¡æ¯...</div>';
            
            try {
                const product = await api.getProduct(code);
                resultDiv.innerHTML = `<div class="success">âœ… å•†å“ä¿¡æ¯è·å–æˆåŠŸ</div><pre>${JSON.stringify(product, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        async function testSPUData() {
            const code = document.getElementById('spuCode').value;
            const resultDiv = document.getElementById('spuResult');
            
            if (!code) {
                alert('è¯·è¾“å…¥å•†å“ä»£ç ');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è·å–SPUæ•°æ®...</div>';
            
            try {
                const spuData = await api.getProductOfficialSPU(code);
                resultDiv.innerHTML = `<div class="success">âœ… SPUæ•°æ®è·å–æˆåŠŸ</div><pre>${JSON.stringify(spuData, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        async function testImageData() {
            const code = document.getElementById('imageCode').value;
            const resultDiv = document.getElementById('imageResult');
            
            if (!code) {
                alert('è¯·è¾“å…¥å•†å“ä»£ç ');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è·å–å›¾ç‰‡æ•°æ®...</div>';
            
            try {
                const imageData = await api.getProductOfficialImages(code);
                resultDiv.innerHTML = `<div class="success">âœ… å›¾ç‰‡æ•°æ®è·å–æˆåŠŸ</div><pre>${JSON.stringify(imageData, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        async function testOfficialData() {
            const code = document.getElementById('officialCode').value;
            const resultDiv = document.getElementById('officialResult');
            const previewDiv = document.getElementById('officialPreview');
            
            if (!code) {
                alert('è¯·è¾“å…¥å•†å“ä»£ç ');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è·å–å®Œæ•´å®˜æ–¹æ•°æ®...</div>';
            previewDiv.innerHTML = '';
            
            try {
                const officialData = await api.getProductOfficialDetail(code);
                resultDiv.innerHTML = `<div class="success">âœ… å®Œæ•´å®˜æ–¹æ•°æ®è·å–æˆåŠŸ</div><pre>${JSON.stringify(officialData, null, 2)}</pre>`;
                
                // æ˜¾ç¤ºé¢„è§ˆ
                if (officialData.spu && officialData.spu.summary) {
                    const summary = officialData.spu.summary;
                    const firstImage = officialData.images && officialData.images.main561 ? 
                        `https://www.uniqlo.cn${officialData.images.main561[0]}` : '';
                    
                    previewDiv.innerHTML = `
                        <div class="product-preview">
                            ${firstImage ? `<img src="${firstImage}" alt="å•†å“å›¾ç‰‡" class="product-image">` : ''}
                            <div class="product-info">
                                <h4>${summary.name || 'æœªçŸ¥å•†å“'}</h4>
                                <p><strong>å®˜æ–¹ä»£ç :</strong> ${officialData.officialCode}</p>
                                <p><strong>é¢œè‰²æ•°é‡:</strong> ${officialData.spu.colorList ? officialData.spu.colorList.length : 0}</p>
                                <p><strong>å°ºç æ•°é‡:</strong> ${summary.sizeList ? summary.sizeList.length : 0}</p>
                                <p><strong>SKUæ•°é‡:</strong> ${officialData.spu.rows ? officialData.spu.rows.length : 0}</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        async function loadProductList() {
            const resultDiv = document.getElementById('productListResult');
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½å•†å“åˆ—è¡¨...</div>';
            
            try {
                const products = await api.getProducts({ limit: 5 });
                
                let html = `<div class="success">âœ… å•†å“åˆ—è¡¨åŠ è½½æˆåŠŸï¼Œå…± ${products.length} ä¸ªå•†å“</div>`;
                
                for (const product of products) {
                    html += `
                        <div style="margin: 1rem 0; padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius-md);">
                            <h4>${product.name_zh} (${product.product_code})</h4>
                            <button onclick="testProductOfficialData('${product.product_code}')" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: var(--primary-500); color: white; border: none; border-radius: var(--radius-md); cursor: pointer;">
                                æµ‹è¯•å®˜æ–¹æ•°æ®
                            </button>
                            <div id="result-${product.product_code}" style="margin-top: 0.5rem;"></div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        async function testProductOfficialData(code) {
            const resultDiv = document.getElementById(`result-${code}`);
            
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è·å–å®˜æ–¹æ•°æ®...</div>';
            
            try {
                const officialData = await api.getProductOfficialDetail(code);
                
                if (officialData.spu || officialData.images) {
                    resultDiv.innerHTML = `<div class="success">âœ… å®˜æ–¹æ•°æ®è·å–æˆåŠŸ</div>`;
                } else {
                    resultDiv.innerHTML = `<div class="error">âš ï¸ æ— æ³•è·å–å®˜æ–¹æ•°æ®</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
